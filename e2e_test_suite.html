<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª E2E Test Suite - Iranian Legal Archive System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'vazir': ['Vazirmatn', 'Tahoma', 'IRANSans', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-vazir" dir="rtl">
    <div class="container mx-auto p-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-4">
                <i class="fas fa-vial ml-3 text-blue-500"></i>
                Ù…Ø¬Ù…ÙˆØ¹Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ End-to-End
            </h1>
            <p class="text-gray-600">ØªØ³Øª Ø¬Ø§Ù…Ø¹ ØªÙ…Ø§Ù… Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ… Ø¢Ø±Ø´ÛŒÙˆ Ø§Ø³Ù†Ø§Ø¯ Ø­Ù‚ÙˆÙ‚ÛŒ Ø§ÛŒØ±Ø§Ù†</p>
        </div>

        <!-- Test Controls -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-semibold">Ú©Ù†ØªØ±Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</h2>
                <div class="flex space-x-3 space-x-reverse">
                    <button id="run-all-tests" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:from-blue-600 hover:to-purple-600 transition-all transform hover:scale-105 shadow-lg">
                        <i class="fas fa-play ml-2"></i>
                        Ø§Ø¬Ø±Ø§ÛŒ Ù‡Ù…Ù‡ ØªØ³Øªâ€ŒÙ‡Ø§
                    </button>
                    <button id="stop-tests" class="px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors" disabled>
                        <i class="fas fa-stop ml-1"></i>
                        ØªÙˆÙ‚Ù
                    </button>
                    <button id="export-results" class="px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors">
                        <i class="fas fa-download ml-1"></i>
                        Ø®Ø±ÙˆØ¬ÛŒ Ù†ØªØ§ÛŒØ¬
                    </button>
                </div>
            </div>
            
            <!-- Test Progress -->
            <div id="test-progress-container" class="hidden">
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <span id="current-test-name" class="text-sm font-medium">Ø¢Ù…Ø§Ø¯Ù‡ Ø³Ø§Ø²ÛŒ...</span>
                        <span id="test-progress-percentage" class="text-sm font-semibold text-blue-600">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="test-progress-bar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                </div>
                <div class="text-sm text-gray-600">
                    <span id="tests-completed">0</span> Ø§Ø² <span id="total-tests">0</span> ØªØ³Øª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡
                </div>
            </div>
        </div>

        <!-- Test Categories -->
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mb-8">
            <!-- UI Tests -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-desktop ml-2 text-blue-500"></i>
                    ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø±Ø§Ø¨Ø· Ú©Ø§Ø±Ø¨Ø±ÛŒ
                </h3>
                <div id="ui-tests" class="space-y-2">
                    <!-- Test items will be populated here -->
                </div>
            </div>

            <!-- API Tests -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-plug ml-2 text-green-500"></i>
                    ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ API
                </h3>
                <div id="api-tests" class="space-y-2">
                    <!-- Test items will be populated here -->
                </div>
            </div>

            <!-- Integration Tests -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 flex items-center">
                    <i class="fas fa-cogs ml-2 text-purple-500"></i>
                    ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ú¯ÛŒ
                </h3>
                <div id="integration-tests" class="space-y-2">
                    <!-- Test items will be populated here -->
                </div>
            </div>
        </div>

        <!-- Test Results Summary -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-2xl font-semibold mb-6 flex items-center">
                <i class="fas fa-chart-bar ml-2 text-orange-500"></i>
                Ø®Ù„Ø§ØµÙ‡ Ù†ØªØ§ÛŒØ¬ ØªØ³Øª
            </h2>
            
            <!-- Summary Cards -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <div class="text-center p-4 bg-blue-50 rounded-lg">
                    <div id="summary-total" class="text-3xl font-bold text-blue-600">0</div>
                    <div class="text-sm text-blue-500">Ú©Ù„ ØªØ³Øªâ€ŒÙ‡Ø§</div>
                </div>
                <div class="text-center p-4 bg-green-50 rounded-lg">
                    <div id="summary-passed" class="text-3xl font-bold text-green-600">0</div>
                    <div class="text-sm text-green-500">Ù…ÙˆÙÙ‚</div>
                </div>
                <div class="text-center p-4 bg-red-50 rounded-lg">
                    <div id="summary-failed" class="text-3xl font-bold text-red-600">0</div>
                    <div class="text-sm text-red-500">Ù†Ø§Ù…ÙˆÙÙ‚</div>
                </div>
                <div class="text-center p-4 bg-purple-50 rounded-lg">
                    <div id="summary-rate" class="text-3xl font-bold text-purple-600">0%</div>
                    <div class="text-sm text-purple-500">Ù†Ø±Ø® Ù…ÙˆÙÙ‚ÛŒØª</div>
                </div>
            </div>
            
            <!-- Detailed Results -->
            <div id="detailed-results" class="space-y-4">
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-flask text-4xl mb-4"></i>
                    <p>Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†ØªØ§ÛŒØ¬ØŒ ØªØ³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-4 left-4 z-50 space-y-2"></div>

    <script>
        // E2E Test Framework
        class E2ETestFramework {
            constructor() {
                this.tests = [];
                this.results = [];
                this.isRunning = false;
                this.currentTestIndex = 0;
                this.apiBase = 'http://127.0.0.1:7860/api';
                this.uiBase = 'http://127.0.0.1:7860/web_ui/';
            }

            init() {
                this.setupTests();
                this.setupEventListeners();
                this.renderTestCategories();
            }

            setupEventListeners() {
                document.getElementById('run-all-tests').addEventListener('click', () => {
                    this.runAllTests();
                });

                document.getElementById('stop-tests').addEventListener('click', () => {
                    this.stopTests();
                });

                document.getElementById('export-results').addEventListener('click', () => {
                    this.exportResults();
                });
            }

            setupTests() {
                // UI Tests
                this.tests.push(...[
                    {
                        category: 'ui',
                        name: 'Navigation System',
                        description: 'ØªØ³Øª Ø³ÛŒØ³ØªÙ… Ù†Ø§ÙˆØ¨Ø±ÛŒ Ùˆ Ù…Ù†ÙˆÙ‡Ø§',
                        test: () => this.testNavigation()
                    },
                    {
                        category: 'ui',
                        name: 'Theme Toggle',
                        description: 'ØªØ³Øª ØªØºÛŒÛŒØ± ØªÙ… Ø±ÙˆØ´Ù†/ØªØ§Ø±ÛŒÚ©',
                        test: () => this.testThemeToggle()
                    },
                    {
                        category: 'ui',
                        name: 'Responsive Design',
                        description: 'ØªØ³Øª Ø·Ø±Ø§Ø­ÛŒ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ',
                        test: () => this.testResponsiveDesign()
                    },
                    {
                        category: 'ui',
                        name: 'Form Validation',
                        description: 'ØªØ³Øª Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ ÙØ±Ù…â€ŒÙ‡Ø§',
                        test: () => this.testFormValidation()
                    }
                ]);

                // API Tests
                this.tests.push(...[
                    {
                        category: 'api',
                        name: 'Status Endpoint',
                        description: 'ØªØ³Øª endpoint ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…',
                        test: () => this.testApiEndpoint('/status')
                    },
                    {
                        category: 'api',
                        name: 'Stats Endpoint',
                        description: 'ØªØ³Øª endpoint Ø¢Ù…Ø§Ø± Ø³ÛŒØ³ØªÙ…',
                        test: () => this.testApiEndpoint('/stats')
                    },
                    {
                        category: 'api',
                        name: 'Network Endpoint',
                        description: 'ØªØ³Øª endpoint Ø´Ø¨Ú©Ù‡ Ùˆ Ù¾Ø±ÙˆÚ©Ø³ÛŒ',
                        test: () => this.testApiEndpoint('/network')
                    },
                    {
                        category: 'api',
                        name: 'Legal DB Stats',
                        description: 'ØªØ³Øª endpoint Ø¢Ù…Ø§Ø± Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡',
                        test: () => this.testApiEndpoint('/legal-db/stats')
                    }
                ]);

                // Integration Tests
                this.tests.push(...[
                    {
                        category: 'integration',
                        name: 'Document Processing Flow',
                        description: 'ØªØ³Øª ÙØ±Ø¢ÛŒÙ†Ø¯ Ú©Ø§Ù…Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ø§Ø³Ù†Ø§Ø¯',
                        test: () => this.testDocumentProcessingFlow()
                    },
                    {
                        category: 'integration',
                        name: 'Search Functionality',
                        description: 'ØªØ³Øª Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¬Ø³ØªØ¬Ùˆ',
                        test: () => this.testSearchFunctionality()
                    },
                    {
                        category: 'integration',
                        name: 'Proxy Management',
                        description: 'ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø±ÙˆÚ©Ø³ÛŒ',
                        test: () => this.testProxyManagement()
                    },
                    {
                        category: 'integration',
                        name: 'Settings Management',
                        description: 'ØªØ³Øª Ù…Ø¯ÛŒØ±ÛŒØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª',
                        test: () => this.testSettingsManagement()
                    }
                ]);
            }

            renderTestCategories() {
                const categories = ['ui', 'api', 'integration'];
                
                categories.forEach(category => {
                    const container = document.getElementById(`${category}-tests`);
                    const categoryTests = this.tests.filter(test => test.category === category);
                    
                    container.innerHTML = categoryTests.map((test, index) => `
                        <div class="test-item flex items-center justify-between p-3 border border-gray-200 rounded-lg" data-test-id="${test.category}-${index}">
                            <div class="flex-1">
                                <div class="font-medium text-gray-800">${test.name}</div>
                                <div class="text-sm text-gray-500">${test.description}</div>
                            </div>
                            <div class="test-status">
                                <i class="fas fa-clock text-gray-400"></i>
                            </div>
                        </div>
                    `).join('');
                });
            }

            async runAllTests() {
                if (this.isRunning) return;
                
                this.isRunning = true;
                this.results = [];
                this.currentTestIndex = 0;
                
                // Show progress
                document.getElementById('test-progress-container').classList.remove('hidden');
                document.getElementById('run-all-tests').disabled = true;
                document.getElementById('stop-tests').disabled = false;
                document.getElementById('total-tests').textContent = this.tests.length;
                
                this.showToast('Ø´Ø±ÙˆØ¹ ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ End-to-End...', 'info');

                for (let i = 0; i < this.tests.length && this.isRunning; i++) {
                    const test = this.tests[i];
                    this.currentTestIndex = i;
                    
                    // Update progress
                    this.updateProgress(test.name, i, this.tests.length);
                    this.updateTestStatus(`${test.category}-${i % this.tests.filter(t => t.category === test.category).length}`, 'running');
                    
                    try {
                        const startTime = Date.now();
                        await test.test();
                        const duration = Date.now() - startTime;
                        
                        this.results.push({
                            test: test.name,
                            category: test.category,
                            status: 'passed',
                            duration: duration,
                            timestamp: new Date().toISOString()
                        });
                        
                        this.updateTestStatus(`${test.category}-${i % this.tests.filter(t => t.category === test.category).length}`, 'passed');
                        
                    } catch (error) {
                        this.results.push({
                            test: test.name,
                            category: test.category,
                            status: 'failed',
                            error: error.message,
                            timestamp: new Date().toISOString()
                        });
                        
                        this.updateTestStatus(`${test.category}-${i % this.tests.filter(t => t.category === test.category).length}`, 'failed');
                    }
                    
                    // Small delay between tests
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                
                this.completeTests();
            }

            stopTests() {
                this.isRunning = false;
                document.getElementById('run-all-tests').disabled = false;
                document.getElementById('stop-tests').disabled = true;
                this.showToast('ØªØ³Øªâ€ŒÙ‡Ø§ Ù…ØªÙˆÙ‚Ù Ø´Ø¯Ù†Ø¯', 'warning');
            }

            updateProgress(testName, current, total) {
                const percentage = Math.round((current / total) * 100);
                document.getElementById('current-test-name').textContent = `Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§: ${testName}`;
                document.getElementById('test-progress-percentage').textContent = `${percentage}%`;
                document.getElementById('test-progress-bar').style.width = `${percentage}%`;
                document.getElementById('tests-completed').textContent = current;
            }

            updateTestStatus(testId, status) {
                const testItem = document.querySelector(`[data-test-id="${testId}"]`);
                if (!testItem) return;
                
                const statusElement = testItem.querySelector('.test-status');
                
                switch (status) {
                    case 'running':
                        statusElement.innerHTML = '<i class="fas fa-spinner fa-spin text-blue-500"></i>';
                        testItem.classList.add('bg-blue-50', 'border-blue-200');
                        break;
                    case 'passed':
                        statusElement.innerHTML = '<i class="fas fa-check-circle text-green-500"></i>';
                        testItem.classList.remove('bg-blue-50', 'border-blue-200');
                        testItem.classList.add('bg-green-50', 'border-green-200');
                        break;
                    case 'failed':
                        statusElement.innerHTML = '<i class="fas fa-times-circle text-red-500"></i>';
                        testItem.classList.remove('bg-blue-50', 'border-blue-200');
                        testItem.classList.add('bg-red-50', 'border-red-200');
                        break;
                }
            }

            completeTests() {
                this.isRunning = false;
                document.getElementById('run-all-tests').disabled = false;
                document.getElementById('stop-tests').disabled = true;
                
                // Update summary
                const total = this.results.length;
                const passed = this.results.filter(r => r.status === 'passed').length;
                const failed = total - passed;
                const successRate = total > 0 ? Math.round((passed / total) * 100) : 0;
                
                document.getElementById('summary-total').textContent = total;
                document.getElementById('summary-passed').textContent = passed;
                document.getElementById('summary-failed').textContent = failed;
                document.getElementById('summary-rate').textContent = `${successRate}%`;
                
                // Show detailed results
                this.renderDetailedResults();
                
                this.showToast(`ØªØ³Øªâ€ŒÙ‡Ø§ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯: ${passed}/${total} Ù…ÙˆÙÙ‚ (${successRate}%)`, 
                             successRate >= 80 ? 'success' : successRate >= 60 ? 'warning' : 'error');
            }

            renderDetailedResults() {
                const container = document.getElementById('detailed-results');
                
                if (this.results.length === 0) return;
                
                container.innerHTML = `
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead>
                                <tr class="border-b border-gray-200">
                                    <th class="text-right py-3 px-2 font-medium text-gray-700">Ù†Ø§Ù… ØªØ³Øª</th>
                                    <th class="text-right py-3 px-2 font-medium text-gray-700">Ø¯Ø³ØªÙ‡</th>
                                    <th class="text-right py-3 px-2 font-medium text-gray-700">ÙˆØ¶Ø¹ÛŒØª</th>
                                    <th class="text-right py-3 px-2 font-medium text-gray-700">Ø²Ù…Ø§Ù† Ø§Ø¬Ø±Ø§</th>
                                    <th class="text-right py-3 px-2 font-medium text-gray-700">Ø¬Ø²Ø¦ÛŒØ§Øª</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${this.results.map(result => `
                                    <tr class="border-b border-gray-100 hover:bg-gray-50">
                                        <td class="py-3 px-2">${result.test}</td>
                                        <td class="py-3 px-2">
                                            <span class="px-2 py-1 bg-gray-100 rounded text-xs">${result.category}</span>
                                        </td>
                                        <td class="py-3 px-2">
                                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs ${result.status === 'passed' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                                <i class="fas ${result.status === 'passed' ? 'fa-check' : 'fa-times'} ml-1"></i>
                                                ${result.status === 'passed' ? 'Ù…ÙˆÙÙ‚' : 'Ù†Ø§Ù…ÙˆÙÙ‚'}
                                            </span>
                                        </td>
                                        <td class="py-3 px-2">${result.duration ? result.duration + 'ms' : '-'}</td>
                                        <td class="py-3 px-2 text-xs text-gray-500">
                                            ${result.error || 'Ø¨Ø¯ÙˆÙ† Ø®Ø·Ø§'}
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // Test Implementations
            async testNavigation() {
                // Simulate navigation testing
                await new Promise(resolve => setTimeout(resolve, 1000));
                return Promise.resolve();
            }

            async testThemeToggle() {
                // Test theme switching
                const currentTheme = document.documentElement.classList.contains('dark') ? 'dark' : 'light';
                document.documentElement.classList.toggle('dark');
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Restore original theme
                if (currentTheme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                
                return Promise.resolve();
            }

            async testResponsiveDesign() {
                // Test responsive design by checking viewport
                const viewportWidth = window.innerWidth;
                if (viewportWidth < 768) {
                    // Mobile test
                    return Promise.resolve();
                } else if (viewportWidth < 1024) {
                    // Tablet test
                    return Promise.resolve();
                } else {
                    // Desktop test
                    return Promise.resolve();
                }
            }

            async testFormValidation() {
                // Test form validation
                await new Promise(resolve => setTimeout(resolve, 800));
                return Promise.resolve();
            }

            async testApiEndpoint(endpoint) {
                const response = await fetch(`${this.apiBase}${endpoint}`);
                if (!response.ok) {
                    throw new Error(`API endpoint ${endpoint} returned ${response.status}`);
                }
                return response.json();
            }

            async testDocumentProcessingFlow() {
                // Test the complete document processing workflow
                try {
                    // Test process-urls endpoint
                    const response = await fetch(`${this.apiBase}/process-urls`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            urls: ['https://example.com/test'],
                            batch_size: 1,
                            use_proxy: false
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`Process endpoint returned ${response.status}`);
                    }
                    
                    return Promise.resolve();
                } catch (error) {
                    throw new Error(`Document processing test failed: ${error.message}`);
                }
            }

            async testSearchFunctionality() {
                // Test search functionality
                try {
                    const response = await fetch(`${this.apiBase}/legal-db/search`, {
                        method: 'GET'
                    });
                    
                    // Accept both 200 and 405 as valid (endpoint exists)
                    if (response.status !== 200 && response.status !== 405) {
                        throw new Error(`Search endpoint returned ${response.status}`);
                    }
                    
                    return Promise.resolve();
                } catch (error) {
                    throw new Error(`Search test failed: ${error.message}`);
                }
            }

            async testProxyManagement() {
                // Test proxy management
                try {
                    const response = await fetch(`${this.apiBase}/network`);
                    if (!response.ok) {
                        throw new Error(`Network endpoint returned ${response.status}`);
                    }
                    return Promise.resolve();
                } catch (error) {
                    throw new Error(`Proxy test failed: ${error.message}`);
                }
            }

            async testSettingsManagement() {
                // Test settings functionality
                try {
                    // Test localStorage functionality
                    const testData = { test: 'settings' };
                    localStorage.setItem('test-settings', JSON.stringify(testData));
                    const retrieved = JSON.parse(localStorage.getItem('test-settings'));
                    localStorage.removeItem('test-settings');
                    
                    if (retrieved.test !== 'settings') {
                        throw new Error('Settings storage test failed');
                    }
                    
                    return Promise.resolve();
                } catch (error) {
                    throw new Error(`Settings test failed: ${error.message}`);
                }
            }

            exportResults() {
                const report = {
                    testSuite: 'Iranian Legal Archive System E2E Tests',
                    timestamp: new Date().toISOString(),
                    summary: {
                        total: this.results.length,
                        passed: this.results.filter(r => r.status === 'passed').length,
                        failed: this.results.filter(r => r.status === 'failed').length,
                        successRate: this.results.length > 0 ? 
                            Math.round((this.results.filter(r => r.status === 'passed').length / this.results.length) * 100) : 0
                    },
                    results: this.results
                };

                const dataStr = JSON.stringify(report, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `e2e-test-results-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showToast('Ù†ØªØ§ÛŒØ¬ ØªØ³Øª ØµØ§Ø¯Ø± Ø´Ø¯', 'success');
            }

            showToast(message, type = 'info') {
                const toast = document.createElement('div');
                const colors = {
                    success: 'bg-green-500',
                    error: 'bg-red-500',
                    warning: 'bg-yellow-500',
                    info: 'bg-blue-500'
                };
                
                toast.className = `${colors[type]} text-white px-4 py-2 rounded-lg shadow-lg transform transition-all duration-300 translate-x-full`;
                toast.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'times' : type === 'warning' ? 'exclamation' : 'info'} ml-2"></i>
                        ${message}
                    </div>
                `;
                
                document.getElementById('toast-container').appendChild(toast);
                
                setTimeout(() => toast.classList.remove('translate-x-full'), 100);
                setTimeout(() => {
                    toast.classList.add('translate-x-full');
                    setTimeout(() => toast.remove(), 300);
                }, 4000);
            }
        }

        // Initialize E2E Test Framework
        document.addEventListener('DOMContentLoaded', () => {
            const testFramework = new E2ETestFramework();
            testFramework.init();
            
            console.log('ğŸ§ª E2E Test Suite initialized');
            console.log(`ğŸ“Š Total tests available: ${testFramework.tests.length}`);
        });
    </script>
</body>
</html>